<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<meta charset="UTF-8"></meta>
<title>demo</title>
<style>
    .datatable-length-row {
        margin-top: 8px;
    }

    .datatable-plus {
        color: #7F879C;
    }

    .datatable-btn {
        margin: 0 2px 0 2px;
    }
</style>
</head>
<body>
<div class="page-header">
    <h1>
        DataTables实例
        <!--<small> 》 dataTableDemo</small>-->
    </h1>
</div>
<div class="row">
    <div class="col-xs-12">
        <div class="table-header">数据列表</div>
        <div>
            <table id="datatable" class="table table-striped table-bordered lTable-font">
            </table>
        </div>
    </div>
</div>
</div>
<form class="form-search">
    <div class="row">
        <div class="col-xs-12 col-sm-8">
            <div class="input-group">


            </div>
        </div>
    </div>
</form>
<!-- /row -->
</body>
</html>
<script type="text/javascript">
    // var scripts =  [null, "static/plugins/dataTables/dist/jquery.dataTables.min.js",null] ;
    $.ace_ajax_finish(function () {
        jQuery(function ($) {
            var dataTable = $("#datatable").dataTable({
                "pagingType": "full_numbers",
                "bAutoWidth": false,
                "language": {
                    "info": "当前为第 _PAGE_ 页，共_PAGES_页_TOTAL_条记录；",
                    "paginate": {
                        "previous": "上一页",
                        "next": "下一页",
                        "last": "末页",
                        "first": "首页",
                        "search": "搜索"
                    },
                    "lengthMenu": "每页显示 _MENU_ 条记录",
                    "search": "搜索：",
                    "infoEmpty": "没有数据信息...",
                    "emptyTable": "表格中没有数据...",
                    "infoFiltered": "(在 _MAX_ 条数据中查询)",
                    "zeroRecords": "没有找到对应的数据"
                },// 页面信息替换
                "columns": [{
                    "data": "id",
                    "name": "id",
                    "title": '<input type="checkbox" name="iCheckGroup" value="all"/>'
                }, {
                    "data": "name",
                    "name": "name",
                    "title": "名称"
                }, {
                    "data": "age",
                    "name": "age",
                    "title": "年龄"
                }, {
                    "data": "username",
                    "name": "username",
                    "title": "昵称"
                }, {
                    "data": "address",
                    "name": "address",
                    "title": "地址"
                }, {
                    "data": "other",
                    "name": "other",
                    "title": "其他"
                }],
                "columnDefs": [
                    {
                        "targets": 0,
                        "width": "3%",
                        "orderable": false,
                        "render": function (data, type, full, meta) {
                            return '<input type="checkbox" name="iCheckGroup" value="' + data + '"/>'; // 创建选择框
                        }
                    } //sorting_asc
                ], // 设置默认值
                "serverSide": true, // 是否开启服务器模式
                "ajax": {
                    "url": "demo/data", // 服务器地址
                    "contentType": "application/json", // 提交参数类型
                    "type": "POST",
                    "data": function (d) {
                        // 修改或添加提交数据
                        var searchVal = $("#search_input").val();
                        if (searchVal == "undefinded") {
                            d.search["value"] = "";
                        }
                        else if (searchVal != "" && searchVal != null) {
                            d.search["value"] = searchVal; // 添加过滤参数
                        } else {
                            d.search["value"] = "";
                        }
                        return JSON.stringify(d);
                    }
                },
                "drawCallback": function (settings) {
                    $("input[name='iCheckGroup']").iCheck({
                        checkboxClass: 'icheckbox_flat-blue'
                    }); // 为选择框添加样式
                    if ($("input[value='all']").is(':checked')) {
                        $("input[name='iCheckGroup']").iCheck('check');
                    }
                    $("input[name='iCheckGroup']").on("ifToggled", function () {
                        if ($(this).is(':checked')) {
                            if ($(this).val() == "all") {
                                $("input[name='iCheckGroup']").iCheck('check');
                            }
                        } else {
                            if ($(this).val() == "all") {
                                $("input[name='iCheckGroup']").iCheck('uncheck');
                            }
                        }
                    });// 绑定表格内checkbox的选择事件
                },
                "dom": '<"#datatable_wrapper.dataTables_wrapper form-inline dt-bootstrap no-footer datatable-plus"' +
                '<"row"<"col-sm-6" <"#datatable_btn_group">><"col-sm-6" <"#datatable_input_search">>>' +
                '<"row"<"col-sm-12" t>>' +
                '<"row"<"col-sm-3" i><"col-sm-3 datatable-length-row" l><"col-sm-6" p>>' +
                '> ',
                "initComplete": function () {
                    $("#datatable_btn_group").append('操作：' +
                        '<button type="button" class="btn btn-success datatable-btn"  data-placement="top" title="添加"><i class="fa fa-plus"></i></button>' +
                        '<button type="button" class="btn btn-primary datatable-btn" data-placement="top" title="修改"><i class="fa fa-edit"></i></button>' +
                        '<button type="button" class="btn btn-danger datatable-btn" data-placement="top" title="删除"><i class="fa fa-trash"></i></button>' +
                        '<button type="button" id="btn_refresh" class="btn btn-info datatable-btn" data-placement="top" title="刷新"><i class="fa fa-refresh"></i></button>');
                    $("#datatable_input_search").attr({
                        "class": "form-group pull-right top_search"
                    });
                    $("#datatable_input_search").append('<div class="input-group">' +
                        '<input type="text" id="search_input" class="form-control search-query" placeholder="请输入搜索内容"/>' +
                        '<span class="input-group-btn">' +
                        '<button type="button" id="btn_search" class="btn btn-purple btn-sm" data-placement="top" title="搜索"><span class="ace-icon fa fa-search icon-on-right bigger-110"></span></button>' +
                        '</span>' +
                        '</div>');
                    /**
                     * 绑定刷新按钮
                     */
                    $("#btn_refresh").click(function () {
                        $("#search_input").val("");
                        reloadTable(); // 刷新页面
                    });
                    /**
                     * 绑定搜索按钮
                     */
                    $("#btn_search").click(function () {
                        var val = $("#search_input").val();
                        if (val.length > 0 && val != null) {
                            reloadTable(); // 刷新页面
                        }
                    });
                }
            }).api();

            /**
             * 刷新表格
             */
            function reloadTable() {
                /*  var $firstPageBtn;
                 var $ul = $("#datatable_paginate > ul");
                 var $liArray = $ul.children();
                 /!**
                 * 遍历分页按钮
                 *!/
                 $liArray.each(function (index, element) {
                 if (index == 0) {
                 $firstPageBtn = $(this); // 记录首页按钮
                 }
                 var isHas = $(this).is('.active');
                 if (isHas) {
                 var val = $(this).text();
                 if (parseInt(val) > 1) {
                 $firstPageBtn.trigger("click"); // 模拟按钮点击事件
                 } else {
                 dataTable.ajax.reload(null, false); // 刷新表格，分页信息不会重置
                 }
                 return false;
                 } // 获取当前选中按钮，若按钮序号大于1，则触发首页点击事件
                 });*/
                dataTable.ajax.reload(function (json) {
                    // 请求到的数据做相应的操作，如详情查看等
                }, true); // 刷新表格，分页信息不会重置
            }

        })
    });
</script>